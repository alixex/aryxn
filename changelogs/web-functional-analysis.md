# Aryxn Web 端整体功能分析报告

## 1. 项目概述

**Aryxn Web** (`@aryxn/web`) 是一个基于 React (Vite) 构建的以用户主权为核心的去中心化多链应用。它的核心定位是**跨链账户管家**与**永久加密文件存储库 (Vault)**。
用户可以通过它管理多条主流区块链上的资产和账户，并基于 Arweave 区块链实现端到端加密的永久文件网络存储。

## 2. 核心模块与功能树

基于对 `apps/web/src/pages` 及相关模块的源码分析，Web 端主要涵盖五大核心业务模块：

### 2.1 账户管理模块 (Account)

**页面**: `Account.tsx`
**功能**:

- **多链支持**: 统一管理 Ethereum, Solana, Sui, Arweave, Bitcoin 等多链账户。
- **内部/外部账户融合**:
  - 支持内部生成和导入账户（通过私钥或助记词导入），采用加密 Vault 在本地安全存储。
  - 支持连接外部插件钱包（如 MetaMask, Phantom 等）。
- **账户详情与资产**: 实时展示各链账户的 Token 余额（通过 `@aryxn/wallet-core` 和各链底层 SDK 计算）。
- **安全机制**: 敏感信息（私钥、助记词）必须通过应用本地的 Master Password 解锁后方可展示，采用本地加密机制保护用户密钥留存安全。

### 2.2 数据看板模块 (Dashboard)

**页面**: `Dashboard.tsx`
**功能**:

- **数据总览**: 直观展示总上传文件数、已占用的永久存储空间总大小、最近一次上传时间等全局统计卡片。
- **文件历史记录 (HistoryTable)**: 整合展示用户的 Arweave 链上文件上传历史，包含文件哈希、大小、加密类型、时间、MIME Type 等详细元数据。
- **链下/链上数据同步**: 应用启动时和浏览器空闲期 (`requestIdleCallback`) 自动从 Arweave 链上扫描和同步文件索引信息到本地 SQLite 缓存，确保历史记录的完整性和列表渲染的高效性。

### 2.3 永久存储上传模块 (Upload)

**页面**: `Upload.tsx`
**功能**:

- **文件处理**: 选择并预览要上传的文件，支持单文件和复合批量的选择模式。
- **隐私保护与加密**: 提供高强度的端到端加密（Encrypt Upload）选择，确保除所有者外任何节点无法查看数据内容；支持数据压缩选项保护隐私并节省上链成本。
- **智能资费与路由**: 实时预估 Arweave 存储所需费用，用户需确认作为付款的 Arweave 账户。若余额不足，可无缝联动 Swap 模块提示跨链桥接（Bridge）或同链兑换（Swap）。
- **上传执行**: 集成了 `@aryxn/arweave` 库以流式分块形式将数据永存至去中心化网络。

### 2.4 跨链交易与路由模块 (Swap / DEX)

**页面**: `Swap.tsx`
**功能**:

- **DEX 聚合交易 (Swap)**: 支持单链资产的兑换。通过集成相关底层路由机制，为用户自动寻找链上的最优汇率执行交易。
- **跨链桥接 (Bridge)**: 非常核心的能力模块，支持在不同公链间进行资产相互转移，用于支撑整个跨链生态流转。
- **资产转账 (Transfer)**: 常规的同链不同账户之间的原生代币与 Token 发送。
- **交易记录跟踪 (History)**: 专门设计的事务历史看板可以查看过往执行的 Swap、Transfer、Bridge 区块链执行记录状态。

### 2.5 系统设置模块 (Settings)

**页面**: `Settings.tsx`
**功能**:

- **本地存储用量与管理**: 调用内置数据库引擎 `db.getStorageInfo()` 可视化应用本地数据的占用情况（包括 OPFS 的文件树数据容量、系统数据库 SQLite 占用、Cache Storage 占用分布情况等）。
- **数据清理 (Danger Zone)**: 允许用户一键式摧毁式清除所有本地应用残留数据，用以强制恢复初始状态或快速释放本地磁盘空间。
- **偏好设定**: 全局国际化多语言切换及其他的应用级使用偏好。

## 3. 技术架构设计特征

- **前端基建**: React + Vite 的组合，带来了现代化、极速的开发与构建体验。
- **轻量路由**: React Router 为核心，具有简单的页面级路由拆分。
- **状态流转设计**: 舍弃传统的重度全局状态树（如 Redux），大量采用了高度封装且以领域驱动的自定义 Hooks 数据流模式 (`useWallet`, `useAccounts`, `useFileSync`, `useUploadHandler` 等），达到了业务逻辑和视图层的深层解耦。
- **UI 设计美学**: 基于 Tailwind CSS 及衍生生态 `shadcn/ui`，辅以自设计的 Mesh Gradient（多色网格渐变）、毛玻璃透明叠加态（Glassmorphism），提供具有顶级科技感与高级视觉审美的多态组件体系。
- **WASM 及浏览器数据库创新**: 深度采用 IndexedDB / OPFS (Origin Private File System) 与 WASM 编译的本地 SQLite，在纯前端浏览器环境构建了足以支撑高并发查询和小文件管理的数据仓储 (`@aryxn/storage`)。

## 4. 总结

Aryxn Web 绝非一个薄脆的传统 DApp 前端展示层。它实质上是一个驻留在用户浏览器环境内的**多链轻节点与本地安全中枢**。通过创造性融合各链 SDK、高度工程化的数据同步策略以及成熟的端到端数据传输系统，它在资产跨链流转、个人数据绝对主权掌控、抗审查云存储等方面，为下一代 Web3 使用者提供了一站式、兼顾性能和优雅体验的超级安全终端。

## 5. 潜在优化方向

### 5.1 性能与加载优化 (Performance & Loading)

- **路由组件懒加载**: 针对繁重的页面级组件（如携带大量 SDK 的页面），通过 React Router 的按需加载特性有效缩减首屏加载体积。
- **数据缓存与分页**: 若 SQLite 中历史文件过多，采用增量分页（Cursor Pagination）取代全量取回，避免阻塞渲染和主线程。

### 5.2 用户体验与渲染 (UX & Rendering)

- **全局后台同步控制**: 将与页面绑定的 `scheduleAutoSync` 上提至全局 Context 或独立的 Background Task 中，防止高频切换路由导致的重复初始化。
- **长列表虚拟滚动**: 针对 `HistoryTable` 内成百上千条的记录，引入长列表虚拟化方案保证滚动丝滑。

### 5.3 代码架构与状态维护 (Architecture & State)

- **衍生状态统一收敛**: 收拢散落的相似判定（如 `needsAccountSetup`），内置于 Hooks 的返回中，提高代码复用率。
- **运行时类型校验增强**: 对跨界入参或存续于库中的本地化弱状态（如 SQLite 提出来的数据），引入更严格的 Schema Runtime Safety 处理。

### 5.4 钱包与网络请求优化 (Network & RPC)

- **统一的 RPC 余额轮询/节流**: 针对全链环境请求，在底层增加附带 TTL 与时间戳缓存机制的 RPC 防抖调度器，避免 API 滥用和 Rate Limit 触发。
